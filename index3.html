<html>
  <head>
    <meta charset="utf-8" />
    <title>Chat Now</title>

    <style>
      * {
        box-sizing: border-box;
      }

      html,
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background: transparent;
      }

      body {
        font-family: 'Roboto', system-ui, -apple-system, sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .chat-dialog {
        width: 480px;
        background: white;
        border: 1px solid #ccc;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
      }

      /* Header */
      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px 15px;
        background: #546e7a;
      }

      .header-text {
        font-family: 'Roboto', sans-serif;
        font-weight: 400;
        font-size: 14px;
        line-height: normal;
        color: rgba(255, 255, 255, 0.8);
        margin: 0;
        font-variation-settings: 'wdth' 100;
      }

      .close-button {
        width: 16px;
        height: 16px;
        cursor: pointer;
        background: transparent;
        border: none;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        color: rgba(255, 255, 255, 0.9);
      }

      .close-button svg {
        display: block;
        width: 100%;
        height: 100%;
      }

      .close-button:hover {
        opacity: 0.8;
      }

      /* Content */
      .content {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        padding: 30px 35px 25px 35px;
        gap: 18px;
        background: white;
      }

      .main-title {
        font-family: 'Roboto', sans-serif;
        font-weight: 500;
        font-size: 25px;
        line-height: 1.3;
        color: rgba(0, 0, 0, 0.8);
        margin: 0;
        font-variation-settings: 'wdth' 100;
      }

      .description {
        font-family: 'Roboto', sans-serif;
        font-weight: 400;
        font-size: 16px;
        line-height: 1.4;
        color: black;
        margin: 0;
        font-variation-settings: 'wdth' 100;
      }

      .chat-link-wrapper {
        align-self: center;
        margin-top: 8px;
      }

      .chat-link {
        font-family: 'Roboto', sans-serif;
        font-weight: 500;
        font-size: 23px;
        line-height: normal;
        color: #0111e0;
        text-decoration: underline;
        text-decoration-skip-ink: none;
        cursor: pointer;
        background: transparent;
        border: none;
        padding: 0;
        font-variation-settings: 'wdth' 100;
      }

      .chat-link:hover {
        opacity: 0.8;
      }

      .checkbox-container {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 10px;
      }

      .checkbox {
        width: 15px;
        height: 15px;
        cursor: pointer;
        flex-shrink: 0;
      }

      .checkbox-label {
        font-family: 'Roboto', sans-serif;
        font-weight: 400;
        font-size: 13px;
        line-height: normal;
        color: black;
        cursor: pointer;
        user-select: none;
        margin: 0;
        font-variation-settings: 'wdth' 100;
      }
    </style>
  </head>

  <body>
    <div class="chat-dialog">
      <!-- Header -->
      <div class="header">
        <p class="header-text">PC Helpsoft PC Cleaner Recommends</p>
        <button class="close-button" id="closeButton" aria-label="Close">
          <svg viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M1 1L13 13M13 1L1 13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>

      <!-- Content -->
      <div class="content">
        <h1 class="main-title">
          Still having performance problems<br>
          with your computer?
        </h1>

        <p class="description">
          Our agents are standing by Chat wan us now to see how we<br>
          can help resolve your PC issues.
        </p>

        <div class="chat-link-wrapper">
          <button class="chat-link" id="chatButton">CHAT NOW</button>
        </div>

        <div class="checkbox-container">
          <input type="checkbox" class="checkbox" id="doNotShowAgain">
          <label class="checkbox-label" for="doNotShowAgain">
            Do not show this windows again
          </label>
        </div>
      </div>
    </div>

    <script>
      // Bridge function for communicating with Sciter host
      async function safeCall(method, payload) {
        if (!window.jsBridgeCall) {
          console.log('❌ jsBridgeCall not found');
          return;
        }
        try {
          const res = await window.jsBridgeCall(method, payload);
          console.log('➡️', method, payload);
          console.log('⬅️', res);
          return res;
        } catch (error) {
          console.error('Bridge call error:', error);
        }
      }

      // Initialize
      window.addEventListener('load', () => {
        safeCall('template:onReady', { type: 'chat_now', ts: Date.now() });

        // Report dialog size to Sciter host
        const dialog = document.querySelector('.chat-dialog');
        if (dialog) {
          setTimeout(() => {
            const width = dialog.offsetWidth;
            const height = dialog.offsetHeight;
            safeCall('template:onSize', { width, height });
          }, 100);
        }
      });

      // Close button
      document.getElementById('closeButton').addEventListener('click', () => {
        safeCall('template:onAction', { action: 'close_webview' });
      });

      // Chat button
      document.getElementById('chatButton').addEventListener('click', () => {
        const doNotShowAgain = document.getElementById('doNotShowAgain').checked;
        safeCall('template:onAction', {
          action: 'chat_now',
          doNotShowAgain: doNotShowAgain
        });
      });

      // Checkbox change
      document.getElementById('doNotShowAgain').addEventListener('change', (e) => {
        safeCall('template:onAction', {
          action: 'checkbox_changed',
          checked: e.target.checked
        });
      });
    </script>
  </body>
</html>
